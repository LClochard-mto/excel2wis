<!DOCTYPE html><html><head><meta charset="utf-8"><title>excel2wisxml_manual.md</title><style></style></head><body id="preview">
<h1><a id="Excel_file_shape_configuration_0"></a>Excel file shape configuration</h1>
<p>Shape of the excel file is set at the beginning of the script for the 4 sheets of the excel file :</p>
<ul>
<li><em>MD Fields</em> (column and row start)</li>
<li><em>Help</em> (associate columns with their names)</li>
<li><em>MD generic</em> (row start and associate columns with their names)</li>
<li><em>MD Thesaurus</em> (col start and associate columns with their names)</li>
</ul>
<p>Be careful always to keep this values consistent with excel file shape, particularly for the delta between <em>MD Fields</em> columns and associated <em>Help</em> rows.</p>
<p>The addition of a column in <em>MD Field</em> or a row in <em>Help</em> does not impact this shape configuration.</p>
<h1><a id="Read_and_parse_excel_file_with_xlrd_12"></a>Read and parse excel file with xlrd</h1>
<p>Get sheets and check excel file shape :</p>
<ul>
<li>Do <em>MD Fields</em> ID match with <em>Help</em> ID ?</li>
<li>Are mandatory fields filled ?</li>
</ul>
<p>If an error is identified the script stops and an appropriate error message is displayed.</p>
<h1><a id="Parse_the_template_as_an_XML_tree_with_etree_19"></a>Parse the template as an XML tree with etree</h1>
<h1><a id="Add_metadata_elements_21"></a>Add metadata elements</h1>
<p>An element is added only when its value is not null.</p>
<h2><a id="1_Generic_metadata__MD_generic__sheet_25"></a>1. Generic metadata (<em>MD generic</em> sheet)</h2>
<p>Each row of <em>MD generic</em> sheet stands for a metadata element. The element’s value is added at the location specified by the xpath. A codelist and an attribute can also be added.</p>
<p>For some elements - identified thanks to their tag name - some other tags are added :</p>
<ul>
<li><strong>Resource locator url</strong><br>
addition of online resource protocol <em>WWW:LINK-1.0-http–link</em></li>
</ul>
<h2><a id="2_Non_generic_metadata__MD_Fields__and__Help__sheets_33"></a>2. Non generic metadata (<em>MD Fields</em> and <em>Help</em> sheets)</h2>
<p>An XML metadata file is generated for each row of MD Field sheet.</p>
<p>For each row :</p>
<ul>
<li><em>MD Fields</em> columns are parsed one by one to get the values ;</li>
<li>linked <em>Help</em> rows are parsed to get :
<ul>
<li>xpath</li>
<li>attribute (is the metadata element an attribute)</li>
<li>thesaurus name</li>
<li>multivalue (do the tag need to be added only once or several times)</li>
<li>codelist value</li>
<li>type (Date or Keyword)</li>
<li>keyword attribute ID</li>
</ul>
</li>
</ul>
<p>Regular case is to add the metadata value (tag or attribute) at the location specified by the xpath.</p>
<p>Other elements can be added according to which <em>Help</em> cells are filled :</p>
<ul>
<li>attribute id for Free Keywwords ;</li>
<li>codeList and codeListValue ;</li>
<li>thesaurus name, date, dateType and codeList (information available in <em>MD Thesaurus</em> sheet) ;</li>
<li>Date elements : dateType and codelist ;</li>
<li>Keyword elements : KeywordType and codeList.</li>
</ul>
<p>Some values are kept in memory such as :</p>
<ul>
<li>URN ;</li>
<li>resource Title ;</li>
<li>file name pattern.</li>
</ul>
<p>Some elements need a specific processing :</p>
<ul>
<li>
<p><strong>URN</strong> [identified with its xpath]</p>
<ul>
<li><em>MD Field</em> Unique identifier value is replaced by the URN - the concatenation of <em>MD generic</em> UID and <em>MD Fields</em> UID</li>
<li>2 <em>MD generic</em> tags are replaced by the concatenation of their value and the URN :
<ul>
<li>location (address) for on-line access</li>
<li>permanent link</li>
</ul>
</li>
<li>If <em>MD generic</em> field <em>OpenWIS only: DCPC local data source</em> is not null, two online resources are added (Suscribe on DCPC and Request on DCPC)</li>
</ul>
</li>
<li>
<p><strong>GTS Priority</strong> [identified with its xpath]<br>
Value is replaced by <em>“GTSPriorityN”</em> with <em>N</em> the 9th character of <em>MD Field</em> cell value</p>
</li>
<li>
<p><strong>File name</strong> [identified with its xpath]<br>
GFNC file name and associated information are added :</p>
<ul>
<li>file description (dynamic value : Resource title)</li>
<li>file type (static value)</li>
<li>file format name (static value)</li>
<li>file format version (static value)</li>
</ul>
</li>
<li>
<p><strong>Free links</strong> [identified with its xpath]<br>
Several links can be added. 3 tags are added for each link :</p>
<ul>
<li>name (optional, URL value if not specified)</li>
<li>protocol (static value)</li>
<li>URL (dynamic value)</li>
</ul>
</li>
<li>
<p><strong>Resource Format</strong> [identified with its xpath]<br>
Several resource formats can be added. 3 tags are added for each resource format (dynamic values) :</p>
<ul>
<li>name</li>
<li>version</li>
<li>specification (optional)</li>
</ul>
</li>
<li>
<p><strong>Tag or group of tags added several times</strong> [Mutlivalue set to Yes]<br>
Add a group of tags as many times as the number of comma-separated values. First multivalued tag to add is suffixed by <em>“[]”</em>.</p>
</li>
</ul>
<h1><a id="Warn_messages_96"></a>Warn messages</h1>
<p>Warn message can be displayed for each metadata in case where :</p>
<ul>
<li>there is a field value but no xpath ;</li>
<li>a xpath is incorrect.</li>
</ul>

</body></html>